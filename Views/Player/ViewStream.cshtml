@model Stream

@{
    ViewData["Title"] = Model.Name + " - " + Model.Collection.Name;
    ViewData["Title:Nav"] = Model.Collection.Name;
    ViewData["Subtitle:Nav"] = Model.Name;
    ViewData["Icon:Nav"] = Model.Collection.Icon;
    ViewData["Color:Nav"] = Model.Collection.DarkColor;
    ViewData["Color:NavBtn"] = Model.Collection.DarkerColor;
    ViewData["Color:Base"] = Model.Collection.BaseColor;
    ViewData["Color:Link"] = Model.Collection.LighterColor;
    ViewData["Color:Accent"] = Model.Collection.LightestColor;
    ViewData["Page:Align"] = "center";
    ViewData["HideLoginUI"] = true;
}

<div id="player"></div>

@section Scripts {
    @inject Microsoft.Extensions.Configuration.IConfiguration Configuration

    @await Html.PartialAsync("_OvenPlayerStartup", new OvenPlayerViewModel(Configuration)
    {
        StreamKey = Model.StreamKey
    })
}

@section Navbar {
    @{
        if (Model.Collection.InstructionType != InstructionType.None)
        {
            <li class="nav-item">
                <a class="nav-btn nav-link nav-link-icon btn btn-outline-secondary" href="#" data-toggle="modal" data-target="#modal-ins-@Model.Collection.InstructionType">
                    <i class="far fa-gamepad-alt"></i>
                    <span class="nav-link-inner--text">How to Play</span>
                </a>
            </li>
        }
    }

    @{
        if (Model.Collection.CallLink != null)
        {
            <li class="nav-item">
                <a class="nav-btn nav-link nav-link-icon btn btn-secondary text-default" href="@Model.Collection.CallLink" target="_blank" style="@{ if (Model.Collection.BaseColor != null) { <text>background-color: @Model.Collection.LighterColor !important; color: @Model.Collection.DarkestColor !important; border: 0;</text> } }">
                    <i class="fas fa-headset"></i>
                    <span class="nav-link-inner--text">Join Call</span>
                </a>
            </li>
        }
    }

    @{
        if (Model.Collection.Private || Model.Private)
        {
            <li class="nav-item">
                <a class="nav-btn nav-link nav-link-icon btn btn-dark text-danger" style="@{ if (Model.Collection.BaseColor != null) { <text>background-color: @Model.Collection.NearBlackColor !important; color: @Model.Collection.LightestColor !important; border: 0;</text> } }"
                    href="#" data-container="body" data-toggle="popover" data-placement="bottom"
                    title="This stream is private" data-content="Please do not share the link to it.">
                    <i class="fas fa-lock"></i>
                </a>
            </li>
        }
        else
        {
            <li class="nav-item">
                <a class="nav-btn nav-link nav-link-icon btn btn-secondary text-default" style="@{ if (Model.Collection.BaseColor != null) { <text>background-color: @Model.Collection.LighterColor !important; color: @Model.Collection.DarkestColor !important; border: 0;</text> } }"
                   href="#" data-container="body" data-toggle="popover" data-placement="bottom" data-html="true"
                   title="Share this stream!" data-content="<a href='@Url.ActionLink("ViewStream", "Player", new { url = @Model.ID })'>@Url.ActionLink("ViewStream", "Player", new { url = @Model.ID })</a>">
                    <i class="fad fa-share-alt"></i>
                </a>
            </li>
        }
    }
}

@* Jackbox Instructions Modal *@
<div class="modal fade" id="modal-ins-Jackbox" tabindex="-1" role="dialog" aria-labelledby="modal-ins-jackbox-label" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modal-ins-jackbox-label">How to Play Jackbox!</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row mb-3 pb-3 justify-content-center border-bottom">
                        Welcome to the Jackbox stream, thanks for joining us! To get started, follow these simple steps:
                    </div>
                    @{
                        if (Model.Collection.CallLink != null)
                        {
                            <div class="row mb-3">
                                <div class="col-4">
                                    <img src="~/images/jackbox/JoinCall.svg" />
                                </div>
                                <div class="col-8 align-self-center">
                                    If you haven't joined the call yet, click the "Join Call" button on the stream page.
                                </div>
                            </div>
                        }
                    }
                    <div class="row mb-3">
                        <div class="col-8 order-2 order-md-1 align-self-center">
                            <p>
                                Go to <a href="https://jackbox.tv">https://jackbox.tv</a> to join the game.
                            </p>

                            <div class="text-muted">
                                Some games will require you to draw, so it's recommended to do this on your phone or tablet.
                            </div>

                            <div class="text-muted">
                                If you only have a laptop, consider joining the audience, or play in a trivia or text game!
                            </div>
                        </div>
                        <div class="col-4 order-1 order-md-2">
                            <img src="~/images/jackbox/Phone.svg" />
                        </div>
                    </div>
                    <div class="row mb-3 pb-3 border-bottom">
                        <div class="col-4">
                            <img src="~/images/jackbox/RoomCode.svg" />
                        </div>
                        <div class="col-8 align-self-center">
                            Enter the room code that's shown on the stream and give yourself a name. When you're ready, click the <strong>PLAY</strong> button!

                            @{
                                if (Model.Collection.CallLink != null)
                                {
                                    <div class="text-muted">
                                        If you can't find the code, try asking in the call or chat.
                                    </div>
                                }
                            }
                        </div>
                    </div>
                    <div class="row mb-3 justify-content-center">
                        You're in! If your name shows up on the screen, you'll be playing in the main game.

                        <div class="text-muted">
                            If you're in the audience, don't worry, you'll still get to vote and participate in the game!
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>